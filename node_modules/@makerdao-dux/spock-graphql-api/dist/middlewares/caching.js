"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.caching = void 0;
const logger_1 = require("@makerdao-dux/spock-etl/dist/utils/logger");
const apicache_1 = require("apicache");
const logger = logger_1.getLogger('API/caching');
function caching(config) {
    const options = {
        appendKey: (req) => config.api.responseCaching.transformKey(JSON.stringify(req.body)),
    };
    const middleware = apicache_1.middleware(config.api.responseCaching.duration, undefined, options);
    logger.info('Using response cache: ', JSON.stringify({ duration: config.api.responseCaching.duration, ...options }));
    return middleware;
}
exports.caching = caching;
//# sourceMappingURL=caching.js.map